{% extends "base.html" %}
{% block content %}

<h1>Setting</h1>

<p class="muted">
  Uma ferramenta de apoio ético para psicólogos que realizam psicoterapia on-line.
  O Setting foi desenvolvido para sustentar o cuidado com o <strong>setting terapêutico digital</strong>,
  oferecendo recursos de organização, reflexão e geração de textos clínicos,
  <strong>sem armazenamento automático de informações sensíveis</strong>.
</p>

<div class="grid">
  <div class="card">
    <h2>Modo Sessão</h2>
    <p>
      Elabore anotações clínicas de apoio à reflexão sobre cada sessão,
      com foco nas <strong>suas intervenções e condutas clínicas</strong>,
      conforme sua abordagem teórica.
      <br><br>
      O Modo Sessão não armazena dados: funciona como um espaço de
      <strong>escrita orientada</strong>, voltado ao registro mínimo necessário
      e ao cuidado ético com a prática.
    </p>
    <a class="btn" href="/modo-sessao">Escrever nota de sessão</a>
  </div>

  <div class="card">
    <h2>Normas</h2>
    <p>
      Consulte resoluções do CFP, diretrizes éticas e referências,
      traduzidas em orientações práticas para o atendimento on-line.
      <br><br>
      O conteúdo tem caráter <strong>formativo e reflexivo</strong>,
      auxiliando decisões sobre privacidade, limites,
      registros e comunicação entre sessões.
    </p>
    <a class="btn" href="/normas">Consultar normas</a>
  </div>

  <div class="card">
    <h2>Documentos</h2>
    <p>
      Gere documentos clínicos em <strong>formato texto (.txt)</strong>,
      como termos, declarações e combinados do setting on-line.
      <br><br>
      Os documentos são preenchidos sob demanda
      e podem ser editados externamente (Word/Docs),
      <strong>sem armazenamento automático</strong>.
    </p>
    <a class="btn" href="/documentos">Gerar documentos</a>
  </div>

  <div class="card">
    <h2>Biblioteca</h2>
    <p>
      Acesse textos autorais e links externos
      para apoio ao estudo e à reflexão sobre psicoterapia on-line.
      <br><br>
      A Biblioteca não funciona como repositório de arquivos clínicos,
      mas como um <strong>espaço formativo</strong>,
      integrado às decisões éticas da prática.
    </p>
    <a class="btn" href="/biblioteca">Explorar referências</a>
  </div>
</div>

<!-- Seção institucional -->
<section class="section-highlight">
  <h2>O que o Setting propõe</h2>
  <p class="muted" style="margin-top:-4px; margin-bottom:14px;">
    Princípios que orientam o desenvolvimento do Setting e o cuidado com a prática clínica digital.
  </p>

  <ul>
    <li>Sustentar o setting clínico no ambiente digital.</li>
    <li>Apoiar decisões éticas na prática mediada por tecnologias.</li>
    <li>Oferecer ferramentas sem armazenamento automático de dados sensíveis.</li>
    <li>Respeitar diferentes abordagens teóricas da Psicologia.</li>
    <li>Evitar a burocratização da clínica e o uso de checklists engessados.</li>
  </ul>
</section>

<!-- ================= ONBOARDING ================= -->

<div id="onboardingOverlay" class="ob-overlay" aria-hidden="true">
  <div class="ob-modal" role="dialog" aria-modal="true" aria-labelledby="obTitle">
    <div class="ob-header">
      <h2 id="obTitle">Boas-vindas ao Setting</h2>
      <button type="button" class="ob-close" aria-label="Fechar" onclick="closeOnboarding(false)">×</button>
    </div>

    <div class="ob-body">
      <ol class="ob-steps">
        <li>
          <strong>Este não é um prontuário clínico.</strong><br>
          O Setting é uma ferramenta de apoio à organização do setting terapêutico on-line.
        </li>
        <li>
          <strong>Registre apenas o essencial.</strong><br>
          Priorize foco, intervenções centrais, combinados e encaminhamentos,
          respeitando o princípio do mínimo necessário.
        </li>
        <li>
          <strong>As decisões clínicas continuam sendo suas.</strong><br>
          O aplicativo não substitui julgamento profissional
          nem as normativas éticas vigentes.
        </li>
      </ol>

      <label class="ob-check">
        <input type="checkbox" id="dontShowOnboarding">
        Não mostrar novamente
      </label>
    </div>

    <div class="ob-actions">
      <button class="btn" onclick="closeOnboarding(true)">Começar</button>
    </div>
  </div>
</div>

<script>
  const ONBOARDING_KEY = "setting_onboarding_v2";

  function showOnboarding() {
    const overlay = document.getElementById("onboardingOverlay");
    if (!overlay) return;
    overlay.style.display = "flex";
    overlay.setAttribute("aria-hidden", "false");
  }

  function closeOnboarding(saveChoice = true) {
    const overlay = document.getElementById("onboardingOverlay");
    const checkbox = document.getElementById("dontShowOnboarding");

    if (saveChoice && checkbox && checkbox.checked) {
      localStorage.setItem(ONBOARDING_KEY, "true");
    }

    if (overlay) {
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    const overlay = document.getElementById("onboardingOverlay");

    if (!localStorage.getItem(ONBOARDING_KEY)) {
      setTimeout(showOnboarding, 250);
    }

    if (overlay) {
      overlay.addEventListener("click", function (e) {
        if (e.target === overlay) closeOnboarding(false);
      });
    }

    document.addEventListener("keydown", function (e) {
      const isOpen = overlay && overlay.style.display === "flex";
      if (isOpen && e.key === "Escape") closeOnboarding(false);
    });
  });
</script>

{% endblock %}
