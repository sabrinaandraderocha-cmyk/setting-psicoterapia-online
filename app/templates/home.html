{% extends "base.html" %}
{% block content %}

<h1>Setting</h1>

<p class="muted">
  Uma ferramenta para psicólogos que realizam psicoterapia on-line.
  O Setting organiza o essencial da prática clínica digital: o cuidado com o setting,
  a continuidade entre sessões e as decisões éticas que atravessam o atendimento mediado por tecnologias.
</p>

<div class="grid">
  <div class="card">
    <h2>Modo Sessão</h2>
    <p>
      Estruture a psicoterapia on-line em três momentos:
      pré-sessão, durante a sessão e pós-sessão.
      Registre foco, intervenções, combinados e encaminhamentos,
      respeitando o mínimo necessário de registro clínico.
    </p>
    <a class="btn" href="/modo-sessao">Acessar Modo Sessão</a>
  </div>

  <div class="card">
    <h2>Normas</h2>
    <p>
      Reúna resoluções do CFP, diretrizes éticas e referências teóricas
      e traduza esses documentos para decisões práticas do atendimento on-line:
      privacidade, limites, registros e comunicação entre sessões.
    </p>
    <a class="btn" href="/normas">Consultar Normas</a>
  </div>

  <div class="card">
    <h2>Documentos</h2>
    <p>
      Organize termos de consentimento, combinados do setting on-line
      e outros documentos necessários à prática clínica mediada por tecnologias,
      com modelos editáveis e geração de versões preenchidas.
    </p>
    <a class="btn" href="/documentos">Gerenciar Documentos</a>
  </div>

  <div class="card">
    <h2>Biblioteca</h2>
    <p>
      Centralize artigos, textos de apoio e produções autorais
      para consulta durante o trabalho clínico.
      Um espaço de estudo permanente integrado à prática da psicoterapia on-line.
    </p>
    <a class="btn" href="/biblioteca">Acessar Biblioteca</a>
  </div>
</div>

<!-- Seção destacada (mais separada e institucional) -->
<section class="section-highlight">
  <h2>O que o Setting propõe</h2>
  <p class="muted" style="margin-top:-4px; margin-bottom:14px;">
    Princípios que orientam o desenvolvimento do Setting e o cuidado com a prática clínica digital.
  </p>

  <ul>
    <li>Sustentar o setting clínico no ambiente digital.</li>
    <li>Apoiar a organização do trabalho psicoterapêutico on-line.</li>
    <li>Facilitar decisões éticas e práticas no uso de tecnologias.</li>
    <li>Respeitar diferentes abordagens teóricas da Psicologia.</li>
  </ul>
</section>

<!-- ================= ONBOARDING ================= -->

<div id="onboardingOverlay" class="ob-overlay" aria-hidden="true">
  <div class="ob-modal" role="dialog" aria-modal="true" aria-labelledby="obTitle">
    <div class="ob-header">
      <h2 id="obTitle">Boas-vindas ao Setting</h2>
      <button type="button" class="ob-close" aria-label="Fechar" onclick="closeOnboarding(false)">×</button>
    </div>

    <div class="ob-body">
      <ol class="ob-steps">
        <li>
          <strong>Este não é um prontuário clínico.</strong>
          O Setting é uma ferramenta de apoio à organização do setting terapêutico on-line.
        </li>
        <li>
          <strong>Registre apenas o essencial.</strong>
          Priorize foco, intervenções centrais, combinados e encaminhamentos,
          respeitando o princípio do mínimo necessário.
        </li>
        <li>
          <strong>As decisões clínicas continuam sendo suas.</strong>
          O aplicativo não substitui julgamento profissional nem as normativas vigentes.
        </li>
      </ol>

      <label class="ob-check">
        <input type="checkbox" id="dontShowOnboarding">
        Não mostrar novamente
      </label>
    </div>

    <div class="ob-actions">
      <button class="btn" onclick="closeOnboarding(true)">Começar</button>
    </div>
  </div>
</div>

<script>
  const ONBOARDING_KEY = "setting_onboarding_v1";

  function showOnboarding() {
    const overlay = document.getElementById("onboardingOverlay");
    if (!overlay) return;
    overlay.style.display = "flex";
    overlay.setAttribute("aria-hidden", "false");
  }

  function closeOnboarding(saveChoice = true) {
    const overlay = document.getElementById("onboardingOverlay");
    const checkbox = document.getElementById("dontShowOnboarding");

    if (saveChoice && checkbox && checkbox.checked) {
      localStorage.setItem(ONBOARDING_KEY, "true");
    }

    if (overlay) {
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    const overlay = document.getElementById("onboardingOverlay");

    if (!localStorage.getItem(ONBOARDING_KEY)) {
      setTimeout(showOnboarding, 250);
    }

    if (overlay) {
      overlay.addEventListener("click", function (e) {
        if (e.target === overlay) closeOnboarding(false);
      });
    }

    document.addEventListener("keydown", function (e) {
      const isOpen = overlay && overlay.style.display === "flex";
      if (isOpen && e.key === "Escape") closeOnboarding(false);
    });
  });
</script>

{% endblock %}
