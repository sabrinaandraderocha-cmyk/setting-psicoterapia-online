{% extends "base.html" %}
{% block content %}

<h1>Notas normativas</h1>
<p class="muted">
  Faça anotações de estudo sobre resoluções, guias e ética profissional. Este módulo <strong>não armazena</strong> as notas:
  você pode <strong>copiar</strong> ou <strong>baixar em .txt</strong>.
</p>

<div class="grid2" style="margin-top:10px; align-items:start;">
  <div class="card">
    <h2>Notas (não armazenável)</h2>

    <label>Título</label>
    <input id="noteTitle" placeholder="Ex.: Resolução CFP 09/2024 — pontos-chave">

    <label>Fonte (opcional)</label>
    <input id="noteSource" placeholder="Link, referência, DOI, etc.">

    <label>Notas</label>
    <textarea id="noteBody" rows="10" placeholder="Resumo prático, insights, aplicação clínica, pontos de atenção..."></textarea>

    <label>Tags (opcional)</label>
    <input id="noteTags" placeholder="Ex.: CFP, LGPD, sigilo, consentimento">

    <div class="row" style="margin-top:10px;">
      <button type="button" class="btn" onclick="copyNote()">Copiar</button>
      <button type="button" class="btn" onclick="downloadNoteTxt()">Baixar .txt</button>
      <button type="button" class="btn" onclick="clearNote()">Limpar</button>
    </div>

    <p class="muted" style="font-size:12px; margin-top:10px;">
      Nota ética: evite incluir dados identificáveis. Prefira sínteses e orientações práticas.
    </p>
  </div>

  <div class="card tip">
    <h2>Instruções</h2>
    <ol style="margin:0; padding-left:18px;">
      <li>Registre a ideia central do documento (título + fonte).</li>
      <li>Transforme a norma em orientação prática (o que fazer/evitar).</li>
      <li>Baixe em .txt e arquive localmente.</li>
    </ol>
    <p class="muted" style="font-size:12px; margin-top:10px;">
      Este espaço é formativo e organizacional. O armazenamento local é de responsabilidade do(a) profissional.
    </p>
  </div>
</div>

<hr style="margin:18px 0; border:none; border-top:1px solid #e5e7eb;">

<h1>Referências rápidas</h1>
<p class="muted" style="margin-top:-6px;">
  Cards fixos para consulta rápida no dia a dia.
</p>

<div class="grid norms-grid" style="margin-top:16px;">

  <div class="card editorial" style="border-left: 5px solid #6A4C93;"> <h2 style="color: #6A4C93;">EthosPsi — Código de Ética de bolso</h2>

    <div class="content">
      <p class="muted">
        Ferramenta essencial para consulta rápida aos artigos do Código de Ética Profissional do Psicólogo (CEPP).
        Ideal para tirar dúvidas pontuais e éticas durante a rotina clínica.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>Recursos:</strong>
        <ul>
          <li>Busca rápida por temas.</li>
          <li>Interface otimizada para consulta ágil (mobile-friendly).</li>
          <li>Foco na prática profissional.</li>
        </ul>
      </div>
    </div>

    <div class="row" style="margin-top:15px;">
      <a class="btn" target="_blank" 
         style="background-color: #6A4C93; color: white; font-weight: bold;"
         href="https://ethospsi.onrender.com/">
        Acessar EthosPsi agora
      </a>
    </div>
  </div>
  <div class="card editorial">
    <h2>Resolução CFP nº 09/2024</h2>

    <div class="content">
      <p class="muted">
        Norma vigente que regulamenta os serviços psicológicos mediados por tecnologias digitais.
        Orienta decisões práticas no atendimento on-line, com foco em ética, sigilo,
        responsabilidade profissional e boas práticas. (Dispensa cadastro no e-Psi.)
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>Resumo prático (o que observar na clínica):</strong>
        <ul>
          <li>Alinhar a prática on-line às diretrizes atuais do CFP.</li>
          <li>Assegurar sigilo, limites de comunicação, registro mínimo necessário e segurança da informação.</li>
          <li>Manter transparência com o paciente: consentimento informado, orientações e combinados do setting digital.</li>
        </ul>
      </div>
    </div>

    <div class="row" style="margin-top:8px;">
      <a class="btn" target="_blank"
         href="https://atosoficiais.com.br/cfp/resolucao-do-exercicio-profissional-n-9-2024-regulamenta-o-exercicio-profissional-da-psicologia-mediado-por-tecnologias-digitais-da-informacao-e-da-comunicacao-tdics-em-territorio-nacional-e-revoga-as-resolucao-cfp-no-11-de-11-de-maio-de-2018-e-resolucao-cfp-no-04-de-26-de-marco-de-2020">
        Abrir Resolução CFP nº 09/2024
      </a>
    </div>
  </div>

  <div class="card editorial">
    <h2>Ferramentas para psicoterapia on-line</h2>

    <div class="content">
      <p class="muted">
        Plataformas de videochamada tendem a oferecer mais estabilidade para sessão do que mensageiros.
        Priorize um setting digital com previsibilidade, privacidade e menos interrupções.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>Recomendação prática:</strong>
        <ul>
          <li><strong>Prefira plataformas de videochamada</strong> (ex.: Google Meet) para reduzir quedas e interferências.</li>
          <li><strong>WhatsApp não é o ideal para sessão</strong>: chamadas podem sofrer interrupções por notificações, instabilidade e limitações do app.</li>
          <li>Combine um <strong>plano de contingência</strong> (ex.: “se cair, retorno em X minutos / canal alternativo”).</li>
          <li>Oriente ambiente privado, fones quando necessário e teste prévio de áudio/vídeo.</li>
        </ul>
      </div>
    </div>

    <div class="row" style="margin-top:8px;">
      <a class="btn secondary" target="_blank"
         href="https://meet.google.com/landing?hs=197&pli=1&authuser=0">
        Abrir Google Meet
      </a>
    </div>
  </div>

  <div class="card editorial">
    <h2>Código de Ética — resumo prático</h2>

    <div class="content">
      <p class="muted">
        Guia rápido para decisões do dia a dia, com foco em sigilo, consentimento, limites e responsabilidade profissional.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>Pontos de atenção:</strong>
        <ul>
          <li><strong>Sigilo é regra:</strong> evite exposição e compartilhe apenas quando estritamente necessário e justificado.</li>
          <li><strong>Consentimento informado:</strong> clareza de finalidade, limites e combinados.</li>
          <li><strong>Registros:</strong> mínimo necessário, finalidade clara, sem excesso de conteúdo sensível.</li>
          <li><strong>Comunicação:</strong> alinhar canais, horários e limites (não substituir sessão).</li>
          <li><strong>Encaminhamentos/supervisão:</strong> fazem parte do cuidado quando necessário.</li>
          <li><strong>Documentos:</strong> linguagem objetiva, foco na finalidade e preservação do sigilo.</li>
        </ul>
      </div>
    </div>

    <div class="row" style="margin-top:8px;">
      <a class="btn secondary" target="_blank"
         href="https://site.cfp.org.br/wp-content/uploads/2012/07/codigo-de-etica-psicologia.pdf">
        Abrir Código de Ética (PDF)
      </a>
    </div>
  </div>

  <div class="card editorial">
    <h2>LGPD na prática psicológica</h2>

    <div class="content">
      <p class="muted">
        Tradução da Lei Geral de Proteção de Dados para decisões cotidianas da clínica psicológica,
        especialmente no atendimento mediado por tecnologias.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>O que a LGPD significa, na prática clínica:</strong>
        <ul>
          <li><strong>Dados pessoais:</strong> informações que identificam alguém.</li>
          <li><strong>Dados sensíveis:</strong> saúde, sofrimento psíquico, sexualidade e vínculos.</li>
          <li><strong>Consentimento informado:</strong> finalidades e limites claros.</li>
          <li><strong>Mínimo necessário:</strong> registre apenas o essencial.</li>
          <li><strong>Segurança:</strong> senhas fortes, 2FA, backups.</li>
          <li><strong>Comunicação:</strong> combinados prévios.</li>
          <li><strong>Arquivamento:</strong> organização ética conforme CFP.</li>
        </ul>

        <strong>Documentos clínicos associados:</strong>
        <ul>
          <li>Termo de Consentimento Livre e Esclarecido (on-line)</li>
          <li>Política de Privacidade</li>
          <li>Combinados de comunicação</li>
        </ul>
      </div>

      <p class="muted" style="font-size:13px;">
        Nota clínica: proteger dados é parte do cuidado com o vínculo terapêutico.
      </p>
    </div>
  </div>

  <div class="card editorial">
    <h2>Consentimento informado (na prática)</h2>

    <div class="content">
      <p class="muted">
        O consentimento não é apenas um documento, mas um processo contínuo
        de alinhamento de expectativas e limites no atendimento on-line.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>O que não pode faltar:</strong>
        <ul>
          <li>Finalidade do atendimento.</li>
          <li>Plataforma utilizada.</li>
          <li>Regras de comunicação.</li>
          <li>Política de faltas e pagamentos.</li>
          <li>Orientações para urgência.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="card editorial">
    <h2>Comunicação entre sessões</h2>

    <div class="content">
      <p class="muted">
        WhatsApp e e-mail fazem parte do setting digital, mas exigem combinados claros.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>Boas práticas:</strong>
        <ul>
          <li>Definir horários e tempo de resposta.</li>
          <li>Limitar mensagens a avisos objetivos.</li>
          <li>Evitar relatos clínicos extensos.</li>
          <li>Orientar serviços adequados em crise.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="card editorial">
    <h2>Para quem está começando na clínica</h2>

    <div class="content">
      <p class="muted">
        Guia prático para sustentar o setting, organizar limites e reduzir ansiedade
        no início da prática clínica.
      </p>

      <div class="muted" style="font-size:14px; line-height:1.6;">
        <strong>Orientações iniciais:</strong>
        <ul>
          <li><strong>O setting sustenta a técnica.</strong></li>
          <li><strong>Supervisão faz parte da prática.</strong></li>
          <li><strong>Limites protegem o vínculo.</strong></li>
          <li><strong>Registro mínimo necessário.</strong></li>
          <li><strong>Encaminhar é cuidar.</strong></li>
        </ul>
      </div>

      <p class="muted" style="font-size:13px;">
        Nota clínica: organização, supervisão e limites claros ajudam a sustentar o processo.
      </p>
    </div>
  </div>

</div>

<script>
  async function copyNote() {
    const title = document.getElementById("noteTitle")?.value?.trim() || "";
    const source = document.getElementById("noteSource")?.value?.trim() || "";
    const tags = document.getElementById("noteTags")?.value?.trim() || "";
    const body = document.getElementById("noteBody")?.value?.trim() || "";

    if (!title && !source && !tags && !body) {
      alert("Não há conteúdo para copiar.");
      return;
    }

    const text =
`NOTAS NORMATIVAS — SETTING

Título: ${title || "—"}
Fonte: ${source || "—"}
Tags: ${tags || "—"}

Notas:
${body || "—"}
`;

    try {
      if (navigator.clipboard && window.isSecureContext) {
        await navigator.clipboard.writeText(text);
        alert("Texto copiado.");
        return;
      }
    } catch (e) {}

    const temp = document.createElement("textarea");
    temp.value = text;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand("copy");
    document.body.removeChild(temp);
    alert("Texto copiado.");
  }

  function clearNote() {
    const title = document.getElementById("noteTitle");
    const source = document.getElementById("noteSource");
    const tags = document.getElementById("noteTags");
    const body = document.getElementById("noteBody");

    const has = (title?.value || "").trim() || (source?.value || "").trim() || (tags?.value || "").trim() || (body?.value || "").trim();
    if (has && !confirm("Limpar as notas atuais?")) return;

    if (title) title.value = "";
    if (source) source.value = "";
    if (tags) tags.value = "";
    if (body) body.value = "";
    title?.focus();
  }

  function downloadNoteTxt() {
    const title = document.getElementById("noteTitle")?.value?.trim() || "";
    const source = document.getElementById("noteSource")?.value?.trim() || "";
    const tags = document.getElementById("noteTags")?.value?.trim() || "";
    const body = document.getElementById("noteBody")?.value?.trim() || "";

    if (!title && !source && !tags && !body) {
      alert("Não há conteúdo para baixar.");
      return;
    }

    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, "0");
    const dd = String(now.getDate()).padStart(2, "0");
    const hh = String(now.getHours()).padStart(2, "0");
    const min = String(now.getMinutes()).padStart(2, "0");

    const safeTitle = (title || "notas").replace(/[^a-zA-Z0-9_-]/g, "_").slice(0, 40);

    const content =
`NOTAS NORMATIVAS — SETTING
Data/hora: ${dd}/${mm}/${yyyy} ${hh}:${min}

Título: ${title || "—"}
Fonte: ${source || "—"}
Tags: ${tags || "—"}

Notas:
${body || "—"}

----------------------------------------
Arquivamento local sob responsabilidade do(a) profissional.
`;

    const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = `notas_${safeTitle}_${yyyy}-${mm}-${dd}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
</script>

{% endblock %}
